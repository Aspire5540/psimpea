
<div class="row">

  <div class="col-md-6">

    <mat-form-field>
        <mat-label>เลือกประเภทงาน</mat-label>
        <mat-select (selectionChange)="selectProject($event)">
          <mat-option *ngFor="let budjet of budjetsType" [value]="budjet.value">
            {{budjet.viewValue}} 
          </mat-option>
        </mat-select>
      </mat-form-field>
  
    <mat-form-field>
      <mat-label>กฟฟ. </mat-label>
      <mat-select (selectionChange)="selectPea($event)">
        <mat-option *ngFor="let pea of peaname" [value]="[pea.peaEng,pea.peaCode,pea.peaName]">
          {{pea.peaCode +" "+pea.peaName}} 
        </mat-option>
      </mat-select>
    </mat-form-field>
</div>
</div>

<div class="row">

<div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 grid-margin stretch-card">
  <div class="card card-statistics border-primary">
    <div class="card-body">
     <h3 class="text-primary">{{this.selPeaName}} จำนวนงานคงค้างรวมทั้งหมด {{totalwbs | number}} งาน</h3>
      <canvas id='myDonut' style="height: 120%;"></canvas>
    </div>
  </div>
</div>


<div class="col-md-6 grid-margin stretch-card">
  <div class="card">
    <div class="card-body">
      <h3 class="text-primary">% ปิดงานแยกตามโครงการ {{this.selPeaName}}</h3>

      <div *ngIf="selBudjetType==1" class="mt-1">{{I1.project}}</div>
      <div *ngIf="selBudjetType==1" class="progress" style="height: 35px;"> 
        <div class="progress-bar bg-dark" role="progressbar" [ngStyle]="{'width': I1.CRTD+'%'}">CRTD {{I1.CRTD | number:'1.0-2'}}%</div>       
        <div class="progress-bar bg-danger" role="progressbar" [ngStyle]="{'width': I1.REL+'%'}">REL {{I1.REL | number:'1.0-2'}}%</div>
        <div class="progress-bar bg-warning" role="progressbar" [ngStyle]="{'width': I1.TECO+'%'}">TECO {{I1.TECO | number:'1.0-2'}}%</div>
        <div class="progress-bar bg-success" role="progressbar" [ngStyle]="{'width': I1.CLSD+'%'}">CLSD {{I1.CLSD | number:'1.0-2'}}%</div>
      </div>

      <div *ngIf="selBudjetType==1"  class="mt-3">{{I2.project}}</div>
      <div *ngIf="selBudjetType==1"  class="progress" style="height: 35px;"> 
        <div class="progress-bar bg-dark" role="progressbar" [ngStyle]="{'width': I2.CRTD+'%'}">CRTD {{I2.CRTD | number:'1.0-2'}}%</div>       
        <div class="progress-bar bg-danger" role="progressbar" [ngStyle]="{'width': I2.REL+'%'}">REL {{I2.REL | number:'1.0-2'}}%</div>
        <div class="progress-bar bg-warning" role="progressbar" [ngStyle]="{'width': I2.TECO+'%'}">TECO {{I2.TECO | number:'1.0-2'}}%</div>
        <div class="progress-bar bg-success" role="progressbar" [ngStyle]="{'width': I2.CLSD+'%'}">CLSD {{I2.CLSD | number:'1.0-2'}}%</div>
      </div>

      <div *ngIf="selBudjetType==2" class="mt-3">{{I3.project}}</div>
      <div *ngIf="selBudjetType==2" class="progress" style="height: 35px;">   
        <div class="progress-bar bg-dark" role="progressbar" [ngStyle]="{'width': I3.CRTD+'%'}">CRTD {{I3.CRTD | number:'1.0-2'}}%</div>     
        <div class="progress-bar bg-danger" role="progressbar" [ngStyle]="{'width': I3.REL+'%'}">REL {{I3.REL | number:'1.0-2'}}%</div>
        <div class="progress-bar bg-warning" role="progressbar" [ngStyle]="{'width': I3.TECO+'%'}">TECO {{I3.TECO | number:'1.0-2'}}%</div>
        <div class="progress-bar bg-success" role="progressbar" [ngStyle]="{'width': I3.CLSD+'%'}">CLSD {{I3.CLSD | number:'1.0-2'}}%</div>
      </div>

      <div *ngIf="selBudjetType==2" class="mt-3">{{I4.project}}</div>
      <div *ngIf="selBudjetType==2" class="progress" style="height: 35px;">   
        <div class="progress-bar bg-dark" role="progressbar" [ngStyle]="{'width': I4.CRTD+'%'}">CRTD {{I4.CRTD | number:'1.0-2'}}%</div>     
        <div class="progress-bar bg-danger" role="progressbar" [ngStyle]="{'width': I4.REL+'%'}">REL {{I4.REL | number:'1.0-2'}}%</div>
        <div class="progress-bar bg-warning" role="progressbar" [ngStyle]="{'width': I4.TECO+'%'}">TECO {{I4.TECO | number:'1.0-2'}}%</div>
        <div class="progress-bar bg-success" role="progressbar" [ngStyle]="{'width': I4.CLSD+'%'}">CLSD {{I4.CLSD | number:'1.0-2'}}%</div>
      </div>

      <div *ngIf="selBudjetType==2" class="mt-3">{{I5.project}}</div>
      <div *ngIf="selBudjetType==2" class="progress" style="height: 35px;">        
        <div class="progress-bar bg-dark" role="progressbar" [ngStyle]="{'width': I5.CRTD+'%'}">CRTD {{I5.CRTD | number:'1.0-2'}}%</div>
        <div class="progress-bar bg-danger" role="progressbar" [ngStyle]="{'width': I5.REL+'%'}">REL {{I5.REL | number:'1.0-2'}}%</div>
        <div class="progress-bar bg-warning" role="progressbar" [ngStyle]="{'width': I5.TECO+'%'}">TECO {{I5.TECO | number:'1.0-2'}}%</div>
        <div class="progress-bar bg-success" role="progressbar" [ngStyle]="{'width': I5.CLSD+'%'}">CLSD {{I5.CLSD | number:'1.0-2'}}%</div>
      </div>

      <div class="mt-5">สถานะงาน</div>
      <div class="progress" style="height: 30px;">        
        <div class="progress-bar bg-dark" role="progressbar" [ngStyle]="{'width': '25%'}">%CRTD</div>
        <div class="progress-bar bg-danger" role="progressbar" [ngStyle]="{'width': '25%'}">%REL</div>
        <div class="progress-bar bg-warning" role="progressbar" [ngStyle]="{'width': '25%'}">%TECO</div>
        <div class="progress-bar bg-success" role="progressbar" [ngStyle]="{'width': '25%'}">%CLSD</div>
      </div>

    </div>
  </div>
</div>
<div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 grid-margin stretch-card">
  <div class="card card-statistics">
    <div class="card-body">
       
      <canvas id='myBar' style="height: 120%;"></canvas>
    </div>
  </div>
</div>
<div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 grid-margin stretch-card">
  <div class="card card-statistics">
    <div class="card-body">
       
      <canvas id='myBar2' style="height: 120%;"></canvas>
    </div>
  </div>
</div>


  <div class="col-md-12">

    <mat-form-field>
      <mat-label>งบ</mat-label>
      <mat-select (selectionChange)="selectBudget($event)">               
        <mat-option *ngFor="let budjet of budjets" [value]="budjet.value" >
          {{budjet.viewValue}}
        </mat-option>
      </mat-select>
    </mat-form-field>  
</div>


<div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 grid-margin stretch-card">
  <div class="card card-statistics">
    <div class="card-body">
      <canvas id='myBar3' style="height: 120%;"></canvas>
    </div>
  </div>
</div>

<div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 grid-margin stretch-card">
  <div class="card card-statistics">
    <div class="card-body">
      <canvas id='myBarClsd' style="height: 120%;"></canvas>
    </div>
  </div>
</div>

<div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 grid-margin stretch-card">
  <div class="card card-statistics">
    <div class="card-body">    
      <canvas id='myBar4' style="height: 120%;"></canvas>
    </div>
  </div>
</div>

<div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 grid-margin stretch-card">
  <div class="card card-statistics">
    <div class="card-body">
       
      <canvas id='myLine1' style="height: 120%;"></canvas>
    </div>
  </div>
</div>


<div class="row">
    <div class="col-lg-12 grid-margin stretch-card">
      <div class="card">
        <div class="card-body">
          <h3 class="text-primary">ข้อมูล %การเบิกจ่าย เดือน มินายน 2562</h3>
           <div class="row">    
              <mat-form-field appearance="legacy">
                  <mat-label>ค้นหาข้อมูล</mat-label>
                  <input matInput placeholder="ระบุข้อมูลที่ต้องการค้นหา" matInput (keyup)="applyFilter($event.target.value)">
                </mat-form-field>
                <mat-form-field>
                    <mat-label>งบ</mat-label>
                    <mat-select (selectionChange)="selectBudget2($event)">               
                      <mat-option *ngFor="let budjet of budjets" [value]="budjet.value" >
                        {{budjet.viewValue}}
                      </mat-option>
                    </mat-select>
                  </mat-form-field> 
            </div>        
          <div class="table-responsive">
              <table class="mat-elevation-z8" mat-table  matSort #sort="matSort" [dataSource]="dataSource">      
  
                <ng-container matColumnDef="wbs">
                <th class="table-lg" mat-header-cell *matHeaderCellDef mat-sort-header> wbs </th>
                <td class="table-lg" mat-cell *matCellDef="let jobprogress">{{jobprogress.wbs}}</td>
                </ng-container>
  
                <ng-container matColumnDef="jobName">
                  <th class="table-lg" mat-header-cell *matHeaderCellDef mat-sort-header>ชื่องาน </th>
                  <td class="table-lg" mat-cell *matCellDef="let jobprogress">{{jobprogress.jobName}}</td>
                </ng-container>
  
                <ng-container matColumnDef="workCostM1">
                  <th class="table-lg" mat-header-cell *matHeaderCellDef mat-sort-header> คชจ. หน้างาน<br>ย้อนหลัง 2 เดือน </th>
                  <td class="table-lg" mat-cell *matCellDef="let jobprogress">{{jobprogress.workCostM1| number:'1.0-2'}}</td>
                </ng-container>
  
                <ng-container matColumnDef="workCostM2">
                    <th class="table-lg" mat-header-cell *matHeaderCellDef mat-sort-header> คชจ. หน้างาน<br>ย้อนหลัง 1 เดือน </th>
                    <td class="table-lg" mat-cell *matCellDef="let jobprogress">
                        <div class="text-success" *ngIf="(jobprogress.workCostM2-jobprogress.workCostM1)>0">{{jobprogress.workCostM2 | number:'1.0-2'}}<i class="mdi mdi-arrow-up"></i></div>
                        <div class="text-danger" *ngIf="(jobprogress.workCostM2-jobprogress.workCostM1)<=0">{{jobprogress.workCostM2 | number:'1.0-2'}}</div></td>
                    
                  </ng-container>
  
                  <ng-container matColumnDef="workCostM3">
                      <th class="table-lg" mat-header-cell *matHeaderCellDef mat-sort-header> คชจ. หน้างาน<br>เดือนปัจจุบัน </th>
                      <td class="table-lg" mat-cell *matCellDef="let jobprogress">
                        <div class="text-success" *ngIf="(jobprogress.workCostM3-jobprogress.workCostM2)>0">{{jobprogress.workCostM3 | number:'1.0-2'}}<i class="mdi mdi-arrow-up"></i></div>
                        <div class="text-danger" *ngIf="(jobprogress.workCostM3-jobprogress.workCostM2)<=0">{{jobprogress.workCostM3 | number:'1.0-2'}}</div></td>
                    
                  </ng-container>
                    
                    <ng-container matColumnDef="matCostM1">
                      <th class="table-lg" mat-header-cell *matHeaderCellDef mat-sort-header> ค่าวัสดุ<br>ย้อนหลัง 2 เดือน </th>
                      <td class="table-lg" mat-cell *matCellDef="let jobprogress">{{jobprogress.matCostM1 | number:'1.0-2'}}</td>
                    </ng-container>
      
                    <ng-container matColumnDef="matCostM2">
                        <th class="table-lg" mat-header-cell *matHeaderCellDef mat-sort-header> ค่าวัสดุ<br>ย้อนหลัง 1 เดือน </th>
                        <td class="table-lg" mat-cell *matCellDef="let jobprogress">
                            <div class="text-success" *ngIf="(jobprogress.matCostM2-jobprogress.matCostM1)>0">{{jobprogress.matCostM2 | number:'1.0-2'}}<i class="mdi mdi-arrow-up"></i></div>
                            <div class="text-danger" *ngIf="(jobprogress.matCostM2-jobprogress.matCostM1)<=0">{{jobprogress.matCostM2 | number:'1.0-2'}}</div></td>
                        
                      </ng-container>
      
                      <ng-container matColumnDef="matCostM3">
                          <th class="table-lg" mat-header-cell *matHeaderCellDef mat-sort-header> ค่าวัสดุ<br>เดือนปัจจุบัน </th>
                          <td class="table-lg" mat-cell *matCellDef="let jobprogress">
                            <div class="text-success" *ngIf="(jobprogress.matCostM3-jobprogress.matCostM2)>0">{{jobprogress.matCostM2 | number:'1.0-2'}}<i class="mdi mdi-arrow-up"></i></div>
                            <div class="text-danger" *ngIf="(jobprogress.matCostM3-jobprogress.matCostM2)<=0">{{jobprogress.matCostM2 | number:'1.0-2'}}</div></td>
                        
                      </ng-container>
  
                <tr class="table-lg" mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr class="table-lg" mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
              </table>
            <mat-paginator #paginator [pageSizeOptions]="[5, 10, 20]" [pageSize]="10" showFirstLastButtons></mat-paginator>
          </div>
        </div>
      </div>
    </div>
  
  </div>
